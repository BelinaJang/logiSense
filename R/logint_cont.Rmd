---
title: "logint_cont"
author: "Jingxuan He"
date: "2024-12-13"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(here)
test_data <- read.csv(here("data", "test_data.csv"))
```


```{r}
# continuous x continuous
logint_con <- function(formula, continuous_var1, continuous_var2, data) {
  
  model <- glm(formula, data = data, family = binomial)
  
  variables_list <- as.list(attr(model$terms, "variables"))[-c(1)]
  outcome <- as.character(variables_list[[1]])
  coefficients <- coef(model)
  
  var1_effect <- coefficients[continuous_var1]
  var2_effect <- coefficients[continuous_var2]
  interaction_effect <- coefficients[grep(":", names(coefficients))]
  
  
  # if any coefficients is NA, return warning message
  if (any(is.na(coefficients))) {
    na_variables <- names(coefficients)[is.na(coefficients)]
    warning(paste0(na_variables," has(have) NA estimates. \n Action Required: Consider re-specifying the model or re-examining interaction terms for meaningfulness. \n"))
  }
  
  sentences <- c(paste0(
    "For an observation with ", continuous_var2, "=value, the odds ratio of '", outcome, "' for increasing ",
    continuous_var1, " by one unit is e^(", signif(var1_effect, 4), 
    " + ", signif(interaction_effect, 4), "*(value)", ").\n"),
    paste0(
      "For an observation with ", continuous_var1, "=value, the odds ratio of '", outcome, "' for increasing ",
      continuous_var2, " by one unit is e^(", signif(var2_effect, 4), 
      " + ", signif(interaction_effect, 4), "*(value)", ").")
    )
  return(cat(sentences))
}
```


```{r}
model <- glm(stroke ~ age*avg_glucose_level, family = binomial, data = test_data)
summary(model)
```

```{r}
logint_con(stroke ~ age*avg_glucose_level, continuous_var1 = "age", 
           continuous_var2 = "avg_glucose_level", data = test_data)
```

